% UNCOMMENT NEXT 3 LINES TO COMPILE MEX FILES %
% mex eikonalnewtheta.cpp
% mex eikonal_homog2.cpp
% mex fastsweeporig.cpp


%%%EXAMPLES$%%%
%N=1/H
%K=1/(Nh)
%test cases are the following:
%1: R=1+.99sin(2pix)sin(2piy)
%2: R=1+.5sin(20pix)sin(20piy)
%3: distance function to (0.5,0.5)
%4: maze with curved obstacles
%5: maze with fast obstacle
%6: generalization of test case 2
%7: homogenization example
%8: random slowness function 

%gamma,delta,x0 are parameters from stability analysis section
%T0 intial theta value 


N=10;
K=15;
test=7;
%compute overall fine solution%
[ORIG,bdrycond,R]=testcase(N,K,test);

Uold=1000*ones(N*K+1,N*K+1);                                                                                                                                                                    
obs=zeros(N*K+1,N*K+1);
paraiter=1; 
sweepiter=5;
gamma=0.01;
delta=0.01;
x0=.1;
T0=0.1;

[Ucoarse,Ufine, wind,fwind]=eikonalnewtheta(Uold,R,bdrycond,obs,N,K,paraiter,sweepiter,T0,gamma,delta,x0);

diff=abs(ORIG-Ufine);

Linferror=max(diff(:))

L1error=sum(diff(:))/(N*K+1)^2 

%contour of fine solutions patched together


figure
X=linspace(0,1,N*K+1);
Y=flip(X);
contourf(X,Y, Ufine,linspace(0,2.5,150))